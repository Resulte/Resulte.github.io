---
layout:     post                    
title:      深度学习学习笔记6-权重衰减和丢弃法             
subtitle:   Dive into deep learning 
date:       2020-10-22              
author:     Resulte                      
header-img: img/post-bg-universe.jpg 
catalog: true                       
tags:                               
    - 深度学习

---

# 深度学习学习笔记6-权重衰减和丢弃法

过拟合现象，即模型的训练误差远小于它在测试集上的误差。虽然增大训练数据集可能会减轻过拟合，但是获取额外的训练数据往往代价高昂。应对过拟合问题的常用方法：权重衰减（weight decay）和丢弃法（dropout）。丢弃法有一些不同的变体。本节中提到的丢弃法特指倒置丢弃法（inverted dropout）。

### 一、权重衰减

权重衰减等价于L2范数正则化（regularization）。正则化通过为模型损失函数添加惩罚项使学出的模型参数值较小，是应对过拟合的常用手段。我们先描述L2范数正则化，再解释它为何又称权重衰减。

L2范数正则化在模型原损失函数基础上添加L2范数惩罚项，从而得到训练所需要最小化的函数。L2范数惩罚项指的是模型权重参数每个元素的平方和与一个正的常数的乘积。以线性回归损失函数

<img src="https://edu-boker.oss-cn-beijing.aliyuncs.com/dl/5/1.jpg" style="zoom:50%;" />

为例，其中w1,w2是权重参数，b是偏差参数，样本ii的输入为x1(i),x2(i)，标签为y(i)，样本数为n。将权重参数用向量**w**=[w1,w2]表示，带有L2范数惩罚项的新损失函数为

<img src="https://edu-boker.oss-cn-beijing.aliyuncs.com/dl/5/2.jpg" style="zoom:50%;" />

其中超参数λ>0。当权重参数均为0时，惩罚项最小。当λ较大时，惩罚项在损失函数中的比重较大，这通常会使学到的权重参数的元素较接近0。当λ设为0时，惩罚项完全不起作用。上式中L2范数平方‖**w**‖^2展开后得到w1^2+w2^2。有了L2范数惩罚项后，在小批量随机梯度下降中，我们将权重w1和w2的迭代方式更改为

<img src="https://edu-boker.oss-cn-beijing.aliyuncs.com/dl/5/3.jpg" style="zoom:50%;" />

可见，L2范数正则化令权重w1和w2先自乘小于1的数，再减去不含惩罚项的梯度。因此，L2范数正则化又叫权重衰减。权重衰减通过惩罚绝对值较大的模型参数为需要学习的模型增加了限制，这可能对过拟合有效。实际场景中，我们有时也在惩罚项中添加偏差元素的平方和。

### 二、丢弃法

以一个单隐藏层的多层感知机为例。其中输入个数为4，隐藏单元个数为5，且隐藏单元hi（i=1,…,5i=1,…,5）的计算表达式为

<img src="https://edu-boker.oss-cn-beijing.aliyuncs.com/dl/5/4.jpg" style="zoom:50%;" />

这里ϕ是激活函数，x1,…,x4是输入，隐藏单元i的权重参数为w1i,…,w4i，偏差参数为bi。当对该隐藏层使用丢弃法时，该层的隐藏单元将有一定概率被丢弃掉。设丢弃概率为p， 那么有p的概率hi会被清零，有1−p的概率hi会除以1−p做拉伸。丢弃概率是丢弃法的超参数。具体来说，设随机变量ξi为0和1的概率分别为p和1−p。使用丢弃法时我们计算新的隐藏单元h′i

<img src="https://edu-boker.oss-cn-beijing.aliyuncs.com/dl/5/5.jpg" style="zoom:50%;" />

即丢弃法不改变其输入的期望值。使用丢弃法，一种可能的结果是其中h2和h5被清零。这时输出值的计算不再依赖h2和h5，在反向传播时，与这两个隐藏单元相关的权重的梯度均为0。由于在训练中隐藏层神经元的丢弃是随机的，即h1,…,h5都有可能被清零，输出层的计算无法过度依赖h1,…,h5中的任一个，从而在训练模型时起到正则化的作用，并可以用来应对过拟合。在测试模型时，我们为了得到更加确定性的结果，一般不使用丢弃法。